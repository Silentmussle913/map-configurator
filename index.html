<!DOCTYPE html>
<html>
<head>
    <title>Bedwars Map JSON Generator</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #1e1e1e; 
            color: white; 
        }
        h1, h2, h3, h4 { color: #f5f5f5; margin-top: 20px; }
        .box { 
            background: #2e2e2e; 
            padding: 15px; 
            margin-bottom: 25px; 
            border-radius: 6px; 
        }
        label { display: block; margin-top: 10px; }
        input, textarea { 
            padding: 7px; 
            margin-top: 5px; 
            width: 100%; 
            background: #1e1e1e; 
            color: white; 
            border: 1px solid #555; 
            border-radius: 4px; 
        }
        button { 
            margin-top: 15px; 
            margin-bottom: 20px;
            padding: 8px 14px; 
            cursor: pointer; 
            background: #444; 
            color: white; 
            border: none; 
            border-radius: 4px; 
        }
        button:hover { background: #666; }

        .genList div, .shopList div, .upgradeList div { margin-bottom: 10px; }
        .mapContainer > .box, .teamsContainer > .box { margin-bottom: 25px; }
    </style>
</head>
<body>

<h1>Bedwars Map JSON Generator</h1>

<div class="mapContainer"></div>
<button onclick="addMap()">+ Add Map</button>

<br><br>
<button onclick="generateJSON()">Generate JSON</button>

<h2 id="jsonTitle" style="display:none;">Generated JSON</h2>
<textarea id="output" style="display:none;" readonly></textarea>

<script>
const container = document.querySelector('.mapContainer');

function addMap() {
    const box = document.createElement('div');
    box.className = 'box';
    box.innerHTML = `
        <label>Map Name:</label>
        <input class="mapName" placeholder="tramble3v3" />

        <h3>Spectator Spawn</h3>
        <input class="specCoords" placeholder="X Y Z" />

        <h3>Generators</h3>
        <div style="margin-bottom:15px;">
            <strong>Diamond Generators</strong>
            <div class="diamondGens genList"></div>
            <button onclick="addGenInput(this, 'diamond')">+ Add Diamond Generator</button>
        </div>
        <div style="margin-top:15px;">
            <strong>Emerald Generators</strong>
            <div class="emeraldGens genList"></div>
            <button onclick="addGenInput(this, 'emerald')">+ Add Emerald Generator</button>
        </div>

        <h3>Teams</h3>
        <div class="teamsContainer"></div>
        <button onclick="addTeam(this)">+ Add Team</button>
    `;
    container.appendChild(box);

    addGenInput(box.querySelector('.diamondGens'), 'diamond');
    addGenInput(box.querySelector('.emeraldGens'), 'emerald');
}

function addGenInput(btnOrContainer, type) {
    let container;
    if (btnOrContainer.tagName === 'BUTTON') {
        container = btnOrContainer.previousElementSibling;
    } else {
        container = btnOrContainer;
    }

    const count = container.children.length + 1;
    const div = document.createElement('div');
    div.innerHTML = `<input placeholder="${type.charAt(0).toUpperCase() + type.slice(1)} Generator ${count} (X Y Z)" />`;
    const input = div.querySelector('input');

    input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            const val = input.value.trim();
            if (val) {
                input.disabled = true;
                input.value = `${type.charAt(0).toUpperCase() + type.slice(1)} Generator ${count}: ${val}`;
                addGenInput(container, type);
            }
        }
    });

    container.appendChild(div);
}

function addTeam(btn) {
    const containerDiv = btn.parentElement.querySelector('.teamsContainer');
    const div = document.createElement('div');
    div.className = 'box';
    div.innerHTML = `
        <label>Team Name:</label>
        <input class="teamName" placeholder="Red" />

        <label>Spawn Point (X Y Z):</label>
        <input class="teamSpawn" placeholder="0 64 0" />

        <label>Bed Position (X Y Z):</label>
        <input class="bedPos" placeholder="0 64 0" />

        <label>Team Generator (X Y Z):</label>
        <input class="teamGen" placeholder="0 64 0" />

        <h4>Shop Positions</h4>
        <div class="shopList"></div>
        <button onclick="addShopInput(this)">+ Add Shop Position</button>

        <h4>Upgrade Positions</h4>
        <div class="upgradeList"></div>
        <button onclick="addUpgradeInput(this)">+ Add Upgrade Position</button>
    `;
    containerDiv.appendChild(div);

    addShopInput(div.querySelector('.shopList'));
    addUpgradeInput(div.querySelector('.upgradeList'));
}

function addShopInput(btnOrContainer) {
    let container = btnOrContainer.tagName === 'BUTTON' ? btnOrContainer.previousElementSibling : btnOrContainer;
    const count = container.children.length + 1;
    const div = document.createElement('div');
    div.innerHTML = `<input placeholder="Shop ${count} (X Y Z)" />`;
    const input = div.querySelector('input');

    input.addEventListener('keydown', function(e) {
        if(e.key === 'Enter') {
            const val = input.value.trim();
            if(val) {
                input.disabled = true;
                input.value = `Shop ${count}: ${val}`;
                addShopInput(container);
            }
        }
    });

    container.appendChild(div);
}

function addUpgradeInput(btnOrContainer) {
    let container = btnOrContainer.tagName === 'BUTTON' ? btnOrContainer.previousElementSibling : btnOrContainer;
    const count = container.children.length + 1;
    const div = document.createElement('div');
    div.innerHTML = `<input placeholder="Upgrade ${count} (X Y Z)" />`;
    const input = div.querySelector('input');

    input.addEventListener('keydown', function(e) {
        if(e.key === 'Enter') {
            const val = input.value.trim();
            if(val) {
                input.disabled = true;
                input.value = `Upgrade ${count}: ${val}`;
                addUpgradeInput(container);
            }
        }
    });

    container.appendChild(div);
}

function parseCoords(str) {
    const parts = str.trim().split(/\s+/).map(Number);
    return { x: parts[0]||0, y: parts[1]||0, z: parts[2]||0 };
}

function parseMultipleCoords(list) {
    const result = [];
    list.querySelectorAll('input').forEach(input => {
        const val = input.value.split(':')[1];
        if(val) result.push(parseCoords(val));
    });
    return result;
}

function generateJSON() {
    const maps = document.querySelectorAll('.mapContainer > .box');
    const result = {};

    maps.forEach(map => {
        const mapName = map.querySelector('.mapName').value.trim();
        if(!mapName) return;

        const specCoords = parseCoords(map.querySelector('.specCoords').value);

        const diamondGens = parseMultipleCoords(map.querySelector('.diamondGens'));
        const emeraldGens = parseMultipleCoords(map.querySelector('.emeraldGens'));

        const teams = [];
        map.querySelectorAll('.teamsContainer > .box').forEach(team => {
            const name = team.querySelector('.teamName').value.trim();
            if(!name) return;

            const spawn_point = parseCoords(team.querySelector('.teamSpawn').value);
            const bed = parseCoords(team.querySelector('.bedPos').value);
            const generator = parseCoords(team.querySelector('.teamGen').value);

            const shop_positions = parseMultipleCoords(team.querySelector('.shopList'));
            const upgrade_positions = parseMultipleCoords(team.querySelector('.upgradeList'));

            teams.push({name, spawn_point, bed, generator, shop_positions, upgrade_positions});
        });

        result[mapName] = {
            spectator_spawn: specCoords,
            generators: { diamond: diamondGens, emerald: emeraldGens },
            teams: teams
        };
    });

    document.getElementById('output').style.display = 'block';
    document.getElementById('jsonTitle').style.display = 'block';
    document.getElementById('output').value = JSON.stringify(result, null, 2);
}

// Initialize page with one map
addMap();
</script>

</body>
</html>
